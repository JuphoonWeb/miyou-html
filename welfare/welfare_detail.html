<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<title>福利详情</title>
	<link rel="stylesheet" type="text/css" href="./static/reset.css">
</head>
<style type="text/css">
	.z_body{
		background: url('./images/detail_bg.png') no-repeat top left;
		background-size: 100%;
	}
	.pic{
		display: block;
		margin:20px auto;
	}
	.desc{
		width: 320px;
		margin: 0 auto;
		font-size: 18px;
		color: #000;
		text-align: center;
		line-height: 1.3;
	}
	.desc i,.role-content i{
		font-style: normal;
		color: rgb(255,87,113);
	}
	.receive{
		width: 285px;
		margin:30px auto 0;
		height: 50px;
		line-height: 50px;
		border-radius: 30px;
		text-align: center;
		font-size: 20px;
		color: #fff;
		background: #ddd;
	}
	.receive.enable{
		background: url('./images/receive_btn.png') no-repeat center;
	}
	.validity{
		width: 170px;
		margin: 0 auto;
		color: rgb(255,87,113);
		padding: 10px 0;
	}
	.role-title,.role-content{
		font-size: 14px;
		color: #000;
		padding: 11px;
	}
	.role-title{
		border-bottom: 0.5px solid rgb(128,128,128);
		
		margin-top: 50px;
	}
	.role-content{
		line-height: 1.5;
	}
</style>

<body class="z_body">
	<img src="./images/pic.png" class="pic">
	<p class="desc J_desc"></p>
	<div class="receive J_receive">立即领取</div>
	<p class="validity">
		<img class="icon" src="./images/icon_3.png">
		活动有效期:还剩<span class="J_remain"></span>天
	</p>
	<p class="role-title">业务规则</p>
	<p class="role-content J_role"><p>
<script type="text/javascript" src="./lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="./static/common.js"></script>
<script type="text/javascript">
	var id = GetQueryString('id'),
		phone = GetQueryString('phone');
	_ajax('get','/api/h5/getWelfare/'+id+'/'+phone,{},function(data){
		var remainDays = getTimeDifference(new Date(),data.data.endTime);
		$('.J_desc').html(data.data.welfareDesc);
		$('.J_remain').text(remainDays);
		$('.J_role').html(data.data.welfareRole);
		if(data.data.isReceive==0){
            $('.J_receive').addClass('enable').attr({
                'data-proid':data.data.welfareProId,
                'data-proname':data.data.welfareProName
            });
		}else{
            $('.J_receive').text('已领取');
		}

	});
	$(document).on('click','.J_receive.enable',function(){
        $('.J_receive').removeClass('enable');
		_ajax('post','/api/h5/eaopPro',{
			'phone':phone,
			'id':id,
			'welfareProId':$('.J_receive').attr('data-proid'),
			'welfareProName':$('.J_receive').attr('data-proname')
		},function(data){
			if(data.data.rettype=="0"){
                $('.J_receive').text('已领取');
				toast('福利已领取</br>请留言稍后短信通知',2000);
			}else{
                $('.J_receive').addClass('enable');
                toast(data.data.retmsg,2000);
			}
		})
	})
</script>
</body>
</html>